<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> WWDC 2018 - 412 Advanced Debugging With Xcode and LLDB · 红纸</title><meta name="description" content="WWDC 2018 - 412 Advanced Debugging With Xcode and LLDB - HongZhi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.zhz.io/atom.xml" title="红纸"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nianran" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">WWDC 2018 - 412 Advanced Debugging With Xcode and LLDB</h1><div class="post-info">Jun 10, 2018</div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>刚做完了这个<a href="https://developer.apple.com/videos/play/wwdc2018/412/" target="_blank" rel="noopener">Advanced Debugging with Xcode and LLDB Session 412</a>的听力练习，来写个小总结(嗯，又可以愉快的开始装逼了)。<br>由于Swift写的不多，可能有几个小部分了解的并不是很全面</p>
<h2 id="增加了Swift-Debug的可靠性"><a href="#增加了Swift-Debug的可靠性" class="headerlink" title="增加了Swift Debug的可靠性"></a>增加了Swift Debug的可靠性</h2><h3 id="Swift第三方库导入方式不正确，导致的属性无法打印问题修正"><a href="#Swift第三方库导入方式不正确，导致的属性无法打印问题修正" class="headerlink" title="Swift第三方库导入方式不正确，导致的属性无法打印问题修正"></a>Swift第三方库导入方式不正确，导致的属性无法打印问题修正</h3><p>产生原因可以直接看这个<a href="https://juejin.im/post/5a52d7cdf265da3e4c07a004" target="_blank" rel="noopener">链接</a><br>实际产生的效果<br><img src="/resources/C377778880889F7F0B8897607C911E7A.jpg" alt="IMAGE"></p>
<h3 id="控制台Swift类型修正"><a href="#控制台Swift类型修正" class="headerlink" title="控制台Swift类型修正"></a>控制台Swift类型修正</h3><p><img src="/resources/CDA3BBFB82087B559010B162AAF25A8F.jpg" alt="IMAGE"><br><a id="more"></a></p>
<h2 id="Debug技巧"><a href="#Debug技巧" class="headerlink" title="Debug技巧"></a>Debug技巧</h2><p>之前看了会儿Advanced Apple Debugging这本书，其实好像上面很多都有写。</p>
<h3 id="多一个工作区的Debug-Tab给开发者来调试"><a href="#多一个工作区的Debug-Tab给开发者来调试" class="headerlink" title="多一个工作区的Debug Tab给开发者来调试"></a>多一个工作区的Debug Tab给开发者来调试</h3><p>当你进入Debug的时候会多出一个Tab来，当然这个并不是默认打开的，你可以去设置里面进行打开<br><img src="/resources/BBC36F839054F738B10C5FD527CFF6A0.jpg" alt="IMAGE"><br><img src="/resources/C56CA051961A7A531A13F4D930D5A098.jpg" alt="IMAGE"><br>Xcode提供了很多选项可供你选择，在Build/Test/Run等的场景开始或者是暂停的时候弹出新的Tab，可定制型还是挺高的。</p>
<h3 id="Expression交换函数结果"><a href="#Expression交换函数结果" class="headerlink" title="Expression交换函数结果"></a>Expression交换函数结果</h3><p>利用expression命令,简写为e,来修改属性的值<br><img src="/resources/285E4FC01E01462E29BBD1BE7DCBF7FD.jpg" alt="IMAGE"><br>当然如果你不想每次运行的时候都这么来敲一遍的话，你可以这么玩<br><img src="/resources/BE23B42AD0FC3BFF07F41C9EAF378E18.jpg" alt="IMAGE"><br>OK，甚至你忘记写某句代码了，但是编译又贼慢，你可以学习一下视频里的这个操作<br><img src="/resources/BC89285073DADF1D47C47A249F9898A9.jpg" alt="IMAGE"><br>图中他少设置了一个Delegate，但是他懒啊，直接用断点添加上，然后假装写一行代码在那（其实他并没有编译咯）。但是这样可以假装写了一个代理赋值。Amazing?</p>
<h3 id="breakpoint-set-–one-shot-true"><a href="#breakpoint-set-–one-shot-true" class="headerlink" title="breakpoint set –one-shot true"></a>breakpoint set –one-shot true</h3><p>OK，看到这个命令一开始是懵逼的，什么鬼东西。但是看到下图应该并不会很陌生，这个是对于UILabel的text字段的全局断点，但是系统的所有设置都会起作用。所以调试的时候还要开关断点啊什么的太麻烦了。所以可以利用上面的这个命令来进行一个修正优化。<br><img src="/resources/0C09C7A80D42093D1A8BACABE50080A8.jpg" alt="IMAGE"><br>我想要在if的判断后面拦截一次-[UILabel setText:]我就可以这么做了<br><img src="/resources/04B30B8BF791028055DA84C3E9FF1A4A.jpg" alt="IMAGE"><br><img src="/resources/4DC633FC7E0FAF3D67388A288A115420.jpg" alt="IMAGE"></p>
<blockquote>
<p>Note: 这边写了one shot 所以我在想有没有断两次的操作，但是在同一个断点设置两次command是没有起作用的。<br>–name只是这个命令的其中一个用法，还有其他用法大家自己探索</p>
</blockquote>
<h3 id="断点移动"><a href="#断点移动" class="headerlink" title="断点移动"></a>断点移动</h3><p>ヾ(｡｀Д´｡)我擦这是什么操作？来段Gif来表达一下我的忧伤，恕我年少无知。<br><img src="/resources/64AC4E1386A9032ED73A4E7B68E4B08D.gif" alt="未命名.gif"><br>！！！运行中的断点竟然还能移动，关键是还能够回退执行。OK，回到正题，这应该是之前就有的吧，我只是不知道而已。视频中介绍了另外一种姿势，我们来学习一下。图中，这句jump的动画被泰国了，执行了手动执行的动画，并且为false。<br><img src="/resources/8561122F2D0DFE9BFF98E8ABF62EDFEA.jpg" alt="IMAGE"></p>
<h3 id="watch-point-属性的监听"><a href="#watch-point-属性的监听" class="headerlink" title="watch point 属性的监听"></a>watch point 属性的监听</h3><p>OK，这就像是运行期的KVO 中set炒作一样理解就OK了。<br>当我们在属性列表里面Watch了之后，就可以捕获到这个属性的变化了<br><img src="/resources/96CC650A97A1106370FBF1FC7D87AEB7.jpg" alt="IMAGE"><br><img src="/resources/E5F2CE69A63044C3CF887BBC228A8778.jpg" alt="IMAGE"></p>
<h3 id="老生常谈的Swift调用OC"><a href="#老生常谈的Swift调用OC" class="headerlink" title="老生常谈的Swift调用OC"></a>老生常谈的Swift调用OC</h3><p>在用Swift的时候，有些OC函数是无法在LLDB中使用的。like view.recursiveDescription。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expression -l objc -O -- &lt;expr&gt;</div></pre></td></tr></table></figure></p>
<p><img src="/resources/5DFB3DE6902432B7376AB079104F19E2.jpg" alt="IMAGE"></p>
<h3 id="断点中，界面刷新"><a href="#断点中，界面刷新" class="headerlink" title="断点中，界面刷新"></a>断点中，界面刷新</h3><p>有时候我们进入了断点，在断点的时候，修改了Frame，但是因为被暂停UI是不会刷新的，所以我们可以手动去调用刷新<em>expression CATransaction.flush()</em>已达到界面刷新的效果</p>
<h3 id="别名"><a href="#别名" class="headerlink" title="别名"></a>别名</h3><p>这个没什么好讲的吧，给刚才的命令取一个简短的名字方便调用罢了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">command alias poc expression -l objc -O --</div><div class="line">command alias 🚽 expression -l objc -- (void)[CATransaction flush]</div></pre></td></tr></table></figure></p>
<p>(用🚽来刷新也是骚的)</p>
<h3 id="用LLDB-Python库来自定义命令"><a href="#用LLDB-Python库来自定义命令" class="headerlink" title="用LLDB-Python库来自定义命令"></a>用LLDB-Python库来自定义命令</h3><p>这部分还是参考别人的文章看看吧<a href="http://southpeak.github.io/2015/01/25/tool-lldb/" target="_blank" rel="noopener">LLDB调试器使用简介</a>,反正以前就有了。</p>
<h3 id="Xib的约束拷贝"><a href="#Xib的约束拷贝" class="headerlink" title="Xib的约束拷贝"></a>Xib的约束拷贝</h3><p>断点的时候进入ViewDebug可以点击相关约束后进行拷贝。在命令行进行粘贴，这样你就能拿到约束对象的地址，进行调试。改完之后要记得刷新界面哦~<br><img src="/resources/C946596F700C273F1E9207A19E9CC749.jpg" alt="IMAGE"><br><img src="/resources/00A0909FA1EA8064E74D401361AFC5A7.jpg" alt="IMAGE"></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>剩下的是dark mode和color的东西，并不是很有兴趣，自行观赏</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这些都只是入门操作，<a href="https://store.raywenderlich.com/products/advanced-apple-debugging-and-reverse-engineering" target="_blank" rel="noopener">进阶入门</a>更多的这本书里面写的更详细一点吧。<br>这些都是提高自己工作效率的东西，但是关键还是在于理解和实战，只有配合好了才能够发挥出最大的效益。单单只有了解就只是个装饰品罢了。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/05/18/记一次-Alfred-Workflow中Confluence改造/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'zhz';
var disqus_identifier = '2018/06/10/WWDC-2018-412-Advanced-Debugging-With-Xcode-and-LLDB/';
var disqus_title = 'WWDC 2018 - 412 Advanced Debugging With Xcode and LLDB';
var disqus_url = 'http://www.zhz.io/2018/06/10/WWDC-2018-412-Advanced-Debugging-With-Xcode-and-LLDB/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//zhz.disqus.com/count.js" async></script><div class="copyright"><p>© 2016 - 2018 <a href="http://www.zhz.io">HongZhi</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-82278125-1",'auto');ga('send','pageview');</script></body></html>